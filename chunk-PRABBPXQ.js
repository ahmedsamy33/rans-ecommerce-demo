import{h as N,k as R}from"./chunk-D5GLOXRK.js";import{a as k}from"./chunk-4D7WS2EX.js";import{a as X}from"./chunk-5NFXXYRK.js";import{a as K}from"./chunk-XAI6QE5B.js";import{c as P,d as O,j as L}from"./chunk-FNEIGVV3.js";import"./chunk-76MIRPDM.js";import{a as J}from"./chunk-UZW6OXPX.js";import{c as z}from"./chunk-DFF2A2V2.js";import{a as W,b as p,d as $,f as h,g as H,r as I}from"./chunk-MTOQREGE.js";import"./chunk-IZOBXTRQ.js";import{b as E,c as Q}from"./chunk-JEHFEJHR.js";import{a as S}from"./chunk-3LCGF45W.js";import{b as j,c as U}from"./chunk-SNTC6ISU.js";import"./chunk-5UOHSEQ7.js";import"./chunk-LGSLEHKQ.js";import{g as V,h as u,i as G}from"./chunk-6ZSGU6WM.js";import"./chunk-WJCMRRD3.js";import"./chunk-SYIRRWMM.js";import"./chunk-T3Q3DASN.js";import"./chunk-LLJ4QRQX.js";import{T as x}from"./chunk-EKTMPHIH.js";import"./chunk-E4P4CAIP.js";import{Ba as D,Gb as s,J as v,Rb as m,Sb as l,Tb as T,Ub as B,Vb as M,_ as w,_b as _,cb as f,ea as r,lb as A,oc as q,qb as C,vc as g}from"./chunk-VU6Q4IP4.js";import{a as i,b as a}from"./chunk-TSRGIXR5.js";var Y=new H(i({},J({label:"Name *",placeholder:"Request Name",key:"name",class:"input-text-gray mb-1",validators:[p.required,p.maxLength(100)],fieldConfig:{type:$.Text}}))),F=new h({label:"Start Date *",key:"startDate",validators:[p.required],class:"date-text-gray",onChange:o=>{let t=new Date(o),e=new Date;e.setHours(0,0,0,0);let n=new Date(e);n.setDate(n.getDate()+1),t<e?b.fieldConfig.minDate=n:b.fieldConfig.minDate=new Date(t.setDate(t.getDate()+1))},fieldConfig:{}}),b=new h({label:"End Date *",key:"endDate",validators:[p.required],class:"date-text-gray",onChange:o=>{F.fieldConfig.maxDate=new Date(new Date(o).setDate(new Date(o).getDate()-1))},fieldConfig:{minDate:new Date(new Date().setDate(new Date().getDate()+1))}}),Z=a(i({},S({text:"Submit",type:u.Submit})),{className:"btn btn--primary w-30"}),ee=a(i({},S({text:"Cancel",color:G.Warn,matType:V.Flat})),{className:"btn btn--light-gray w-30"});var c=class o extends U{constructor(){super(j.InitiateRequest)}static \u0275fac=function(e){return new(e||o)};static \u0275prov=w({token:o,factory:o.\u0275fac,providedIn:"root"})};var y=class o{#e=r(Q);#t=r(c);card=A({});cardId=D(0);onTakeAction=D.required();formFields=[Y,F,b];buttons=[ee,Z];buttonClass="justify-content-start";ngOnInit(){}onTakeEvent(t){let{buttonConfig:e,value:n}=t;e.type===u.Submit?(t.buttonConfig.isLoading=!0,this.onSubmit(e,n)):this.onTakeAction()({buttonConfig:e,value:n},()=>{})}onSubmit(t,e){this.cardId()?this.updateRequest(t,e):this.addNewRequest(t,e)}addNewRequest(t,e){this.#t.create(e).pipe(v(()=>t.isLoading=!1)).subscribe(n=>{this.#e.addAlert(i({message:"New Request Initiated successfully"},E)),this.onTakeAction()({buttonConfig:t,value:e??{}},()=>{})})}updateRequest(t,e){this.#t.update(a(i({},e),{id:this.cardId()})).pipe(v(()=>t.isLoading=!1)).subscribe(n=>{this.#e.addAlert(i({message:"Request updated successfully"},E)),this.onTakeAction()({buttonConfig:t,value:e??{}},()=>{})})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=C({type:o,selectors:[["app-initiate-new-request"]],inputs:{cardId:[1,"cardId"],onTakeAction:[1,"onTakeAction"]},features:[g([x(),c])],decls:1,vars:5,consts:[[3,"event","initValue","formFields","buttons","isStickyForm","buttonClass"]],template:function(e,n){e&1&&(m(0,"lib-muk-dynamic-form",0),_("event",function(oe){return n.onTakeEvent(oe)}),l()),e&2&&s("initValue",n.card())("formFields",n.formFields)("buttons",n.buttons)("isStickyForm",!0)("buttonClass",n.buttonClass)},dependencies:[I],encapsulation:2})};var ne=class o{#e=r(z);router=r(O);#t=r(k);tabs=X();buttons={buttons:[R],parentClass:""};formFields=[N];refreshProcessList=!1;ngOnInit(){this.initialize(),this.getProcessCounts()}initialize(){N.onChange=t=>this.onChangeValue(t),R.onClick=t=>this.openDialog({title:`${t?.element?"Edit":"Initiate New"}  Request`,content:null,component:y,inputs:t?.element?{userId:t.element.id}:{}},{width:"500px",height:"550px",panelClass:"custom-panel-class"})}openDialog(t,e){let n=this.#e.openDialog(a(i({},t),{inputs:a(i({},t.inputs),{onTakeAction:d=>this.onSendModalTakeEvent(d,n)})}),e)}onSendModalTakeEvent=(t,e)=>{let{buttonConfig:n}=t;if(n.type===u.Submit){let d=this.router.url;this.router.navigateByUrl("/",{skipLocationChange:!0}).then(()=>{this.router.navigateByUrl(d,{skipLocationChange:!0})})}e.close()};onChangeValue(t){}getProcessCounts(){this.#t.adminProcessCounts().subscribe(t=>this.tabs.forEach(e=>e.title=`${e.title} (${t[e.status]??0})`))}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=C({type:o,selectors:[["app-process"]],features:[g([k])],decls:10,vars:4,consts:[[1,"flex","justify-between","mb-4"],[1,"title-section"],[1,"title-page","mb-2","lg:mb-0"],[1,"flex","justify-end","items-end","gap-4"],[3,"formFields"],[3,"config"],[3,"tabLinks","isBorderTabs"],["content",""]],template:function(e,n){e&1&&(m(0,"div",0)(1,"div",1)(2,"div",2),q(3,"Productivity Process"),l()(),m(4,"div",3),T(5,"lib-muk-dynamic-form",4)(6,"lib-muk-dynamic-buttons",5),l()(),m(7,"lib-muk-nav-tabs",6),B(8,7),T(9,"router-outlet"),M(),l()),e&2&&(f(5),s("formFields",n.formFields),f(),s("config",n.buttons),f(),s("tabLinks",n.tabs)("isBorderTabs",!0))},dependencies:[L,P,K,W,I],encapsulation:2})};export{ne as ProcessComponent};
