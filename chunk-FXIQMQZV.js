import{b as pe}from"./chunk-65HZ7TTF.js";import"./chunk-BYXBJQAS.js";import{a as me}from"./chunk-WLU2AH7Q.js";import"./chunk-BYXBJQAS.js";import{a as Bt,d as se}from"./chunk-F7N4OOQB.js";import{a as ne,b as oe,c as re,d as le}from"./chunk-SHNVGYBB.js";import{b as Y,d as Rt,e as wt,j as Nt}from"./chunk-FNEIGVV3.js";import{a as lt,c as st}from"./chunk-76MIRPDM.js";import{a as ae}from"./chunk-UZW6OXPX.js";import{a as qt,b as zt,c as $t}from"./chunk-DFF2A2V2.js";import{a as j}from"./chunk-Q75O5SUG.js";import"./chunk-V24KNJUK.js";import{b as Yt,d as Wt,e as Jt,g as Kt,h as mt,i as Qt,k as Xt,m as Zt,n as te,o as ee,p as ie,q as K,r as Q}from"./chunk-MTOQREGE.js";import"./chunk-IZOBXTRQ.js";import{b as Ht,c as J}from"./chunk-JEHFEJHR.js";import{a as W}from"./chunk-3LCGF45W.js";import{a as L,b as k,c as Ut}from"./chunk-SNTC6ISU.js";import"./chunk-5UOHSEQ7.js";import{b as ot,c as rt,d as G}from"./chunk-LGSLEHKQ.js";import{g as Gt,h as P,i as Vt}from"./chunk-6ZSGU6WM.js";import{a as kt,b as jt}from"./chunk-WJCMRRD3.js";import"./chunk-SYIRRWMM.js";import"./chunk-T3Q3DASN.js";import{a as H,b as Pt}from"./chunk-LLJ4QRQX.js";import"./chunk-EKTMPHIH.js";import"./chunk-E4P4CAIP.js";import{Aa as Ft,Ba as D,Bc as At,Cc as z,D as ht,Dc as Lt,Ec as nt,Fb as St,Gb as c,Gc as C,I as Ct,Ib as It,J as _t,Lb as Dt,Mb as at,Nb as xt,Pb as B,Qb as q,Qc as Mt,Rb as l,Rc as Ot,Sb as m,Tb as x,Tc as $,W as bt,Xb as R,_ as Et,_a as V,_b as b,ac as y,cb as s,db as Tt,ea as f,f as gt,je as N,lb as h,mc as g,na as S,oa as I,oc as u,p as _,pc as w,q as vt,qb as F,qc as E,vc as A,xb as U}from"./chunk-VU6Q4IP4.js";import{a as n,b as o,d as yt}from"./chunk-TSRGIXR5.js";var ce=new Jt({label:"Evidence Doc (Optional) ",key:"evidenceDocument",class:"right-side input-white  col-span-12 md:col-span-3",fieldConfig:{styleHeight:"",styleWidth:12,fileOptions:{disableDelete:!1,maxFilesLimit:2,maxFileSize:50,maxFilesSize:100,allowedExtensions:[".xls",".xlsm",".xlsx",".xlt"]},isSelected:!0,isRequired:!1}}),pt=new Qt({label:"Note (Optional)",placeholder:"Write Note...",key:"notes",validators:[Yt.maxLength(100)],class:"input-text-gray mb-1",fieldConfig:{rows:4}}),ue=o(n({},W({text:"Save Draft",type:P.Submit})),{id:"save-draft",className:"btn btn--primary save-draft"}),de=o(n({},W({text:"Submit",type:P.Submit})),{id:"submit",className:"btn btn--primary w-30"}),fe=o(n({},W({text:"Cancel",color:Vt.Warn,matType:Gt.Flat})),{className:"btn btn--light-gray w-30"});var v=class i extends Ut{constructor(){super(`${k.processEmployeeActivity}`)}getActivitiesList(t){return this.getAll(t).pipe(_(e=>e.payload))}getObjectiveList(t){return this.getAll(t,`${L.baseUrl+k.objective}/employee/dropdown`).pipe(_(e=>e.payload))}getActivityList(t){return this.getAll(t,`${L.baseUrl+k.processEmployeeActivity}/dropdown`).pipe(_(e=>e.payload))}submitOrDraftActivity(t,e="submit"){return this.create(t,`${L.baseUrl+k.processEmployeeActivity}/${e}`)}static \u0275fac=function(e){return new(e||i)};static \u0275prov=Et({token:i,factory:i.\u0275fac})};var Z=class i{constructor(t){this.dialogRef=t}#e=f(v);#i=f(J);#t=f(zt).inputs;formFields=[ce,pt];buttons=[ue,fe,de];activity=D();#a;ngOnInit(){pt.value=this.#t.activity.notes??""}onTakeEvent(t){let{buttonConfig:e,value:a}=t;if(e.type===P.Submit){t.buttonConfig.isLoading=!0;let r=a,{evidenceDocument:p}=r,d=yt(r,["evidenceDocument"]);this.uploadedTemplate(e,o(n({},d),{activityId:this.#t.activity.id}))}else this.dialogRef.close()}uploadedTemplate(t,e){return this.#e.submitOrDraftActivity(e,t.id).pipe(_t(()=>t.isLoading=!1)).subscribe({next:a=>{this.#i.addAlert(n({message:`Template ${t.id==="submit"?"Uploaded":"Drafted"} successfully`},Ht)),this.dialogRef.close(!0)}})}onFormGroupChange(t){this.#a=t}static \u0275fac=function(e){return new(e||i)(Tt(qt))};static \u0275cmp=F({type:i,selectors:[["app-submit-upload"]],inputs:{activity:[1,"activity"]},features:[A([v])],decls:2,vars:3,consts:[[1,"stc-upload"],[3,"formGroupChange","event","formFields","buttons","isStickyForm"]],template:function(e,a){e&1&&(l(0,"div",0)(1,"lib-muk-dynamic-form",1),b("formGroupChange",function(p){return a.onFormGroupChange(p)})("event",function(p){return a.onTakeEvent(p)}),m()()),e&2&&(s(),c("formFields",a.formFields)("buttons",a.buttons)("isStickyForm",!0))},dependencies:[Q],styles:[".save-draft{position:absolute!important;width:141px!important;bottom:10px!important;left:10px!important}  .stc-upload .sticky-form{height:55vh!important}"]})};var be=(i,t)=>t.title;function Ee(i,t){if(i&1&&(l(0,"mat-chip",1),u(1),m()),i&2){let e=t.$implicit,a=y();It("active-sub-filter-chip",e.active),c("routerLink",e==null?null:e.link)("queryParams",e.queryParams)("relativeTo",a.route)("queryParamsHandling",e.queryParamsHandling),s(),w(e.title)}}var tt=class i{chips=D.required();route=f(Y);static \u0275fac=function(e){return new(e||i)};static \u0275cmp=F({type:i,selectors:[["app-chips-tabs"]],inputs:{chips:[1,"chips"]},decls:3,vars:0,consts:[[3,"routerLink","queryParams","relativeTo","queryParamsHandling","active-sub-filter-chip"],[3,"routerLink","queryParams","relativeTo","queryParamsHandling"]],template:function(e,a){e&1&&(l(0,"mat-chip-set"),B(1,Ee,2,7,"mat-chip",0,be),m()),e&2&&(s(),q(a.chips()()))},dependencies:[K,te,ie,Nt,wt],encapsulation:2})};var M=new mt(o(n({},lt({placeholder:"Obj Name",key:"objectiveIds",parentClass:"grid grid-cols-12 gap-4x",class:"left-side dropdown-no-border col-span-12 md:col-span-2"})),{fieldConfig:o(n({},st()),{isSearchable:!0,isMultiple:!0,options:h([]),optionsConfig:{labelPath:"name",valuePath:"id"}})})),O=new mt(o(n({},lt({placeholder:"Activity Name",key:"activitiesId",parentClass:"grid grid-cols-12 gap-4x",class:"left-side dropdown-no-border col-span-12 md:col-span-2"})),{fieldConfig:o(n({},st()),{isSearchable:!0,isMultiple:!0,options:h([]),optionsConfig:{labelPath:"name",valuePath:"id"}})})),ut=new Xt({key:"date",class:"left-side date-no-border data-ranger",isDisabled:h(!1),fieldConfig:{placeholderStartDate:"From",placeholderEndDate:"To"}}),dt=new Kt(n({},ae({placeholder:"Search....",key:"query",class:"right-side input-white  col-span-12 md:col-span-3",icon:"search",fieldConfig:{type:Wt.Search}}))),ye=[M,O,ut,dt];function Fe(i,t){if(i&1){let e=R();l(0,"mat-chip-row",6),b("removed",function(){let r=S(e).$implicit,p=y();return I(p.removeChip(r))}),u(1),l(2,"button",7)(3,"mat-icon"),u(4,"close"),m()()()}if(i&2){let e=t.$implicit;s(),E(" ",e.name," "),s(),St("aria-label","remove "+e.name)}}var et=class i{#e=f(N);formFields=ye;#i=new gt;#t;#a=f(v);filterChange=Ft();filterData={};objectivesFilter=h(n({},j));activitiesFilter=h(n({},j));selectedChips=h([]);activityList=h([]);objectiveList=h([]);constructor(){this.initializeFilterActions(),this.listenToSearchTyping(),$(()=>{this.setDropdownOptions()})}objectiveDropdown=G({request:()=>this.objectivesFilter(),loader:({request:t})=>this.#a.getObjectiveList(t).pipe(_(e=>{let a=o(n({},e),{content:e.content.map(r=>o(n({},r),{filterType:"OBJECTIVE"}))});return this.objectiveList.update(r=>[...r,...a.content]),a}))});activitiesDropdown=G({request:()=>this.activitiesFilter(),loader:({request:t})=>this.#a.getActivityList(t).pipe(_(e=>{let a=o(n({},e),{content:[...e.content.map(r=>o(n({},r),{filterType:"ACTIVITY"}))]});return this.activityList.update(r=>[...r,...a.content]),a}))});setDropdownOptions(){M.fieldConfig.options.set(this.objectiveList()||[]),O.fieldConfig.options.set(this.activityList()||[])}initializeFilterActions(){this.handleFilterFieldsSearchEvents(),this.handleFilterFieldsChangeEvents(),this.handleFilterFieldsScrollEvents()}resetActivitiesFilter(){this.activitiesFilter.update(t=>o(n({},t),{pageable:o(n({},t.pageable),{pageIndex:0})}))}resetObjectivesFilter(){this.objectivesFilter.update(t=>o(n({},t),{pageable:o(n({},t.pageable),{pageIndex:0})}))}handleFilterFieldsSearchEvents(){M.fieldConfig.onSearch=t=>{this.resetObjectivesFilter(),this.objectiveList.set([]),this.objectivesFilter.update(e=>o(n({},e),{keyword:t??""}))},O.fieldConfig.onSearch=t=>{this.resetActivitiesFilter(),this.activityList.set([]),this.activitiesFilter.update(e=>o(n({},e),{activitySearchKeyword:t??""}))}}handleFilterFieldsChangeEvents(){M.onChange=t=>{this.updateChips(this.objectiveList()||[],t),this.updateFilterData("objectiveIds",t)},O.onChange=t=>{this.updateChips(this.activityList()||[],t),this.updateFilterData("activitiesId",t)},ut.onChange=t=>this.onChangeDate(t),dt.onChange=t=>this.#i.next(t)}updateFilterData(t,e){t==="objectiveIds"&&this.activitiesFilter.update(a=>o(n({},a),{[t]:e})),this.filterData=o(n({},this.filterData),{[t]:e}),this.filterChange.emit(this.filterData)}removeDuplicateChips(t){return t.filter((e,a,r)=>a===r.findIndex(p=>p.id===e.id))}updateChips(t,e){let a=t.filter(r=>e.includes(r.id));this.selectedChips.update(r=>{let p=r.filter(d=>e.includes(d.id)||!t.some(T=>T.id===d.id));return this.removeDuplicateChips([...p,...a])})}handleFilterFieldsScrollEvents(){M.fieldConfig.onScroll=()=>{this.objectiveList().length<this.objectiveDropdown.value()?.totalElements&&this.objectivesFilter.update(t=>o(n({},t),{pageable:o(n({},t.pageable),{pageIndex:t.pageable.pageIndex+1})}))},O.fieldConfig.onScroll=()=>{this.activityList().length<this.activitiesDropdown.value()?.totalElements&&this.activitiesFilter.update(t=>o(n({},t),{pageable:o(n({},t.pageable),{pageIndex:t.pageable.pageIndex+1})}))}}removeChip(t){t.filterType==="DATE"&&(this.#t?.get("date")?.setValue(null),this.#t?.get("date")?.updateValueAndValidity(),this.filterChange.emit(o(n({},this.filterData),{startDate:"",endDate:""}))),this.selectedChips.update(e=>e.filter(a=>a.id!==t.id)),t.filterType==="OBJECTIVE"?this.setValueAtFormGroup("objectiveIds",t.id):t.filterType==="ACTIVITY"&&this.setValueAtFormGroup("activitiesId",t.id)}setValueAtFormGroup(t,e){let a=this.#t?.get(t)?.value?.filter(r=>r!=e);this.#t?.get(t)?.setValue(a)}onChangeDate(t){if(t&&t.end!=""){let{start:e,end:a}=t;e=this.#e.transform(e,"yyyy-MM-dd"),a=this.#e.transform(a,"yyyy-MM-dd");let r=this.#e.transform(e,"d MMMM yyyy"),p=this.#e.transform(a,"d MMMM yyyy");this.selectedChips.update(d=>[...d.filter(T=>T.filterType!=="DATE"),{id:"DATE_RANGE",filterType:"DATE",name:`${r} - ${p||""}`}]),this.filterChange.emit(o(n({},this.filterData),{startDate:e,endDate:a})),this.objectivesFilter.update(d=>o(n({},d),{start:e,end:a})),this.activitiesFilter.update(d=>o(n({},d),{start:e,end:a}))}}listenToSearchTyping(){this.#i.pipe(ht(1e3),Ct()).subscribe(t=>{this.filterData=o(n({},this.filterData),{activitySearchKeyword:t.trim()??""}),this.filterChange.emit(this.filterData)})}onFormGroupChange(t){t&&(this.#t=t)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=F({type:i,selectors:[["app-activity-filter"]],outputs:{filterChange:"filterChange"},features:[A([N,v])],decls:9,vars:1,consts:[[1,"grid","grid-cols-12","gap-1","items-baseline"],[1,"col-span-12","lg:col-span-1"],[1,"text-grey-200","text-sm","w-20","font-medium","text-start","lg:text-center"],[1,"col-span-12","lg:col-span-11"],[3,"formGroupChange","formFields"],[1,"sub-status","flex","flex-wrap","w-[65%]"],[3,"removed"],["matChipRemove",""]],template:function(e,a){e&1&&(l(0,"section",0)(1,"div",1)(2,"div",2),u(3,"Filter by"),m()(),l(4,"div",3)(5,"lib-muk-dynamic-form",4),b("formGroupChange",function(p){return a.onFormGroupChange(p)}),m()()(),l(6,"div",5),B(7,Fe,5,2,"mat-chip-row",null,xt),m()),e&2&&(s(5),c("formFields",a.formFields),s(2),q(a.selectedChips()))},dependencies:[Q,Pt,H,K,Zt,ee],encapsulation:2})};var Te=(i,t,e,a,r,p,d,T,it)=>[i,t,e,a,r,p,d,T,it];function Se(i,t){if(i&1&&(l(0,"div",16),x(1,"img",17),l(2,"span",18),u(3),m()()),i&2){let e=t.item;s(),c("src","./assets/icons/obj.svg",V),s(),c("matTooltip",e==null||e.objective==null?null:e.objective.name),s(),w(e==null||e.objective==null?null:e.objective.name)}}function Ie(i,t){if(i&1&&(l(0,"div",16)(1,"span",18),u(2),m()()),i&2){let e=t.item;s(),c("matTooltip",e==null?null:e.name),s(),w(e==null?null:e.name)}}function De(i,t){if(i&1&&(l(0,"div",19),u(1),m()),i&2){let e=t.item;s(),E(" ",e==null?null:e.weight.toFixed(2)," % ")}}function xe(i,t){if(i&1&&(l(0,"div",16),x(1,"img",20),l(2,"span",18),u(3),m()()),i&2){let e=t.item,a=y();s(),c("src",a.imgUrl+(e.pomCustodian==null?null:e.pomCustodian.profileImage),V),s(),c("matTooltip",e==null||e.pomCustodian==null?null:e.pomCustodian.name),s(),E(" ",e.pomCustodian==null?null:e.pomCustodian.name," ")}}function Ae(i,t){if(i&1&&(l(0,"div",16),x(1,"img",20),l(2,"span",18),u(3),m()()),i&2){let e=t.item,a=y();s(),c("src",a.imgUrl+(e.lineManger==null?null:e.lineManger.profileImage),V),s(),c("matTooltip",e==null||e.lineManger==null?null:e.lineManger.name),s(),E(" ",e.lineManger==null?null:e.lineManger.name," ")}}function Le(i,t){if(i&1&&(l(0,"div",21),u(1),z(2,"date"),m()),i&2){let e=t.item;c("matTooltip",e.startDate),s(),E(" ",nt(2,2,e.startDate,"d MMMM yyyy")," ")}}function Me(i,t){if(i&1&&(l(0,"div",21),u(1),z(2,"date"),m()),i&2){let e=t.item;c("matTooltip",e.endDate),s(),E(" ",nt(2,2,e.endDate,"d MMMM yyyy")," ")}}function Oe(i,t){if(i&1&&(l(0,"div",16)(1,"span"),u(2),z(3,"capitalize"),m()()),i&2){let e=y().item;s(),Dt("truncate-width stc-status status-",e==null?null:e.status.toLowerCase(),""),s(),E(" ",Lt(3,4,e==null?null:e.status)," ")}}function Re(i,t){i&1&&u(0," ____ ")}function we(i,t){if(i&1&&U(0,Oe,4,6,"div",16)(1,Re,1,0),i&2){let e=t.item;at(e!=null&&e.status?0:1)}}function Ne(i,t){if(i&1){let e=R();l(0,"div",16)(1,"button",22),b("click",function(){S(e);let r=y().item,p=y();return I(p.openDialog(r))}),u(2,"submit"),m()()}}function Pe(i,t){if(i&1&&(l(0,"button",23,9)(2,"mat-icon"),u(3,"more_vert"),m()(),l(4,"mat-menu",null,10)(6,"button",24),x(7,"img",25),l(8,"span"),u(9,"Attachments"),m()()()),i&2){let e=g(5);c("matMenuTriggerFor",e)}}function ke(i,t){if(i&1&&U(0,Ne,3,0,"div",16)(1,Pe,10,1),i&2){let e=y();at(e.status()!=="SUBMITTED"?0:1)}}var ft=class i{#e=f(Rt);#i=f(Y);#t=f($t);#a=f(J);#n=f(v);tableConfig=pe;imgUrl=L.imgURL;status=D.required();queryParams=rt(this.#i.queryParams,{initialValue:{}});statusTabs=Mt(()=>{let t=this.queryParams().subStatus,e=[{title:"All",link:".",queryParams:{subStatus:"ALL"},active:t==="ALL"||!t},{title:"Pending",link:".",queryParams:{subStatus:"PENDING"},active:t==="PENDING"},{title:"Overdue",link:".",queryParams:{subStatus:"OVERDUE"},active:t==="OVERDUE"},{title:"Draft",link:".",queryParams:{subStatus:"DRAFT"},active:t==="DRAFT"}],a=[{title:"All",link:".",queryParams:{subStatus:"ALL"},active:t==="ALL"||!t},{title:"Completed on time",link:".",queryParams:{subStatus:"SUBMITTED"},active:t==="SUBMITTED"},{title:"Delayed Submission",link:".",queryParams:{subStatus:"DELAYED_SUBMISSION"},active:t==="DELAYED_SUBMISSION"}];return this.status()==="ASSIGNED"?e:a});filterCriteriaSource$=vt([ot(this.queryParams),ot(this.status)]).pipe(_(([t])=>({statuses:t?.subStatus&&t?.subStatus!="ALL"?[t?.subStatus]:this.status()==="ASSIGNED"?["PENDING","OVERDUE","DRAFT"]:["DELAYED_SUBMISSION","SUBMITTED"]})),bt(t=>this.resetPagination()));filterCriteria=Ot({source:rt(this.filterCriteriaSource$),computation:(t,e)=>n(n(n({},j),e?.value),t)});activities=G({request:()=>this.filterCriteria(),loader:({request:t})=>this.#n.getActivitiesList(t)});constructor(){$(()=>{let{content:t,totalElements:e}=this.activities.value()||{};this.tableConfig.dataSource=new Bt(t||[]),this.tableConfig.totalElements||(this.tableConfig.totalElements=e||0)})}onFilterChange(t){this.filterCriteria.update(e=>n(n({},e),t))}onPaginatorChange(t){this.filterCriteria.update(e=>o(n({},e),{pageable:o(n({},e.pageable),{pageIndex:t,pageSize:e.pageable?.pageSize||5})})),this.tableConfig.pageIndex=t}openDialog(t){this.#t.openDialog({title:"Submit",message:"",content:null,component:Z,inputs:{activity:t}},{width:"700px",height:"570px"}).afterClosed().subscribe(a=>{a&&this.filterCriteria.update(r=>n({},r))})}onFilter(t){this.tableConfig.totalElements=0,this.filterCriteria.update(e=>n(n({},e),t))}resetPagination(){this.tableConfig.pageIndex=0,this.tableConfig.totalElements=0,this.filterCriteria.update(t=>o(n({},t),{pageable:o(n({},t.pageable),{pageIndex:0,pageSize:t.pageable?.pageSize||12})}))}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=F({type:i,selectors:[["app-employee-activity-list"]],inputs:{status:[1,"status"]},features:[A([v])],decls:23,vars:13,consts:[["objective",""],["activity",""],["activityWeight",""],["pmoCustodian",""],["lineManager",""],["startDate",""],["endDate",""],["tableStatus",""],["action",""],["menuTrigger","matMenuTrigger"],["menu","matMenu"],[3,"chips"],[1,"section-wrapper"],[3,"paginatorChange","config","contents"],["actions","",1,"table-actions"],[3,"filterChange"],[1,"flex","items-center","gap-3"],["alt","person-icon",1,"w-9","h-9","object-cover",3,"src"],[1,"truncate-width",3,"matTooltip"],[1,"flex","items-center","gap-3","text-primary","font-semibold","justify-content-center"],["onerror","this.onerror=null;this.src='./assets/images/icons/avatar.png';","alt","person-icon",1,"w-5","h-5","rounded-full","object-cover",3,"src"],[1,"flex","items-center","gap-3","truncate-width",3,"matTooltip"],[1,"btn-submit-light",3,"click"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-menu-item","",1,"flex","items-center"],["src","./assets/icons/btns/view-details.svg","alt","view-details"]],template:function(e,a){if(e&1){let r=R();x(0,"app-chips-tabs",11),l(1,"section",12)(2,"lib-muk-table",13),b("paginatorChange",function(d){return S(r),I(a.onPaginatorChange(d))}),l(3,"div",14)(4,"app-activity-filter",15),b("filterChange",function(d){return S(r),I(a.onFilter(d))}),m()()()(),U(5,Se,4,3,"ng-template",null,0,C)(7,Ie,3,2,"ng-template",null,1,C)(9,De,2,1,"ng-template",null,2,C)(11,xe,4,3,"ng-template",null,3,C)(13,Ae,4,3,"ng-template",null,4,C)(15,Le,3,5,"ng-template",null,5,C)(17,Me,3,5,"ng-template",null,6,C)(19,we,2,1,"ng-template",null,7,C)(21,ke,2,1,"ng-template",null,8,C)}if(e&2){let r=g(6),p=g(8),d=g(10),T=g(12),it=g(14),ge=g(16),ve=g(18),he=g(20),Ce=g(22);c("chips",a.statusTabs),s(2),c("config",a.tableConfig)("contents",At(3,Te,[r,p,d,T,it,ge,ve,he,Ce]))}},dependencies:[se,jt,kt,tt,N,et,me,le,oe,ne,re,H],encapsulation:2})};export{ft as default};
