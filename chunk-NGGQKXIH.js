import{a as y,b as je,c as w,d as ue,e as B,f as G,g as he,h as fe,i as oe,j as Ye,k as Qe}from"./chunk-WFL2HFP5.js";import"./chunk-BYXBJQAS.js";import{a as W,b as v,c as Je,d as He}from"./chunk-F7N4OOQB.js";import"./chunk-SHNVGYBB.js";import{b as Re,d as Te}from"./chunk-FNEIGVV3.js";import{a as k}from"./chunk-2FFOQCPS.js";import{a as qe}from"./chunk-CGFSL3JU.js";import{a as ie,b as Ke,c as j}from"./chunk-76MIRPDM.js";import"./chunk-UZW6OXPX.js";import{c as we}from"./chunk-DFF2A2V2.js";import{a as g}from"./chunk-XE4SEQK7.js";import{a as I,b as N}from"./chunk-Q75O5SUG.js";import"./chunk-V24KNJUK.js";import{a as ke,b as P,h as q,m as ze,o as $e,q as We,r as ne}from"./chunk-MTOQREGE.js";import"./chunk-IZOBXTRQ.js";import{a as Be,b as Ge,c as Ve}from"./chunk-JEHFEJHR.js";import{a as ge}from"./chunk-3LCGF45W.js";import{a as xe,b as Le,c as Pe}from"./chunk-SNTC6ISU.js";import"./chunk-5UOHSEQ7.js";import"./chunk-LGSLEHKQ.js";import{g as te,h as b,i as L,j as De}from"./chunk-6ZSGU6WM.js";import{a as Z,b as ee}from"./chunk-WJCMRRD3.js";import"./chunk-SYIRRWMM.js";import"./chunk-T3Q3DASN.js";import{a as Ue,b as Oe}from"./chunk-LLJ4QRQX.js";import"./chunk-EKTMPHIH.js";import"./chunk-E4P4CAIP.js";import{Ba as me,Db as Me,Eb as Ee,Fb as Ae,Gb as d,Gc as X,J as K,Lb as be,Mb as pe,Nb as ce,Ob as Ne,Pb as z,Qb as $,Rb as l,Sb as c,Tb as E,Xb as Y,_ as ye,_a as H,_b as A,ac as h,cb as r,ea as u,je as de,lb as S,mc as Q,na as U,oa as O,oc as f,p as _e,pc as _,qb as M,qc as ve,vc as x,xa as Se,xb as D,zc as Fe}from"./chunk-VU6Q4IP4.js";import{a as s,b as p}from"./chunk-TSRGIXR5.js";var F=new q(p(s({},Ke({label:"Email *",placeholder:" Select Email",class:"input-gray mb-2",key:"email",validators:[P.required],isDisabled:S(!1)})),{fieldConfig:p(s({},j()),{options:S([]),optionsConfig:{labelPath:"email",valuePath:"email"},isSearchable:!0,searchConfig:{placeholder:"Search for Email",noEntriesFound:""},onRemove:n=>console.log("remove",n),onButtonClick:n=>console.log(n),onScroll:n=>console.log("onScroll",n),onSearch:n=>console.log("onSearch",n)})})),V=new q(p(s({},ie({label:"Role *",placeholder:" Select Role",key:"roleIds",validators:[P.required]})),{class:"input-gray mb-2",fieldConfig:p(s({},j()),{isMultiple:!0,isSearchable:!0,placeholder:"Select an option...",options:S([]),optionsConfig:{labelPath:"roleName",valuePath:"id"},searchConfig:{placeholder:"Search for Roles",noEntriesFound:""},onRemove:n=>console.log("remove",n),onButtonClick:n=>console.log(n),onScroll:n=>console.log("onScroll",n),onSearch:n=>console.log("onSearch",n)}),onChange:n=>console.log("onChange",n)})),R=new q(p(s({},ie({label:"PMO *",placeholder:" Select PMO Custodian",key:"pmoCustodianId"})),{class:"hidden",fieldConfig:p(s({},j()),{isSearchable:!0,options:S([]),optionsConfig:{labelPath:"name",valuePath:"id"}})})),T=new q(p(s({},ie({label:"Line Manager *",placeholder:" Select Line Manager",key:"lineManagerId"})),{class:"hidden",fieldConfig:p(s({},j()),{isSearchable:!0,options:S([]),optionsConfig:{labelPath:"name",valuePath:"id"}})})),Xe=p(s({},ge({text:"Cancel",color:L.Warn,matType:te.Flat})),{className:"btn btn--light-gray w-30"}),Ze=p(s({},ge({text:"Submit",type:b.Submit})),{className:"btn btn--primary w-30"});var ae=class n{onTakeAction=me.required();#s=u(y);#d=u(k);#o=g(I);#t=g(I);#e=g(I);#a=u(Ve);#n;#i=[];#l=[];#m=[];#p=[];#c=g(N);#r=g(N);#g=g(N);userId=me(0);formFields=[F,V,T,R];buttons=[Xe,Ze];buttonClass="justify-content-start";user=S({});ngOnInit(){this.initialize(),!this.userId()&&this.getEmployees(),this.getRoles(),this.userId()&&this.getUserById(),this.getLineManagers(),this.getPMOCustodian()}initialize(){F.fieldConfig.onSearch=e=>this.getEmployees(e),F.isDisabled.set(!1),F.fieldConfig.isSearchable=!0,V.onChange=e=>this.updateFormFields(e),V.fieldConfig.onScroll=()=>this.onScroll("ROLES"),V.fieldConfig.onSearch=e=>this.onSearch(e,"ROLES"),T.fieldConfig.onScroll=()=>this.onScroll("LINE_MANAGER"),T.fieldConfig.onSearch=e=>this.onSearch(e,"LINE_MANAGER"),R.fieldConfig.onScroll=()=>this.onScroll("PMO_CUSTODIAN"),R.fieldConfig.onSearch=e=>this.onSearch(e,"PMO_CUSTODIAN")}getEmployees(e){this.#s.getSearchValues(e).subscribe(t=>{this.#l=t,F.fieldConfig.options.set(this.#l)})}getRoles(e){this.#d.getAll(this.#o).subscribe({next:t=>{let{content:i}=t.payload;this.#i=e?i:[...this.#i,...i],this.userId()&&this.#i.unshift(...this.user()?.roles||[]),this.setRoles(),this.#c.totalItems=t.payload.totalElements}})}setRoles(){this.userId()&&(this.#i=[...new Map(this.#i.map(e=>[e.id,e])).values()]),V.fieldConfig.options.set(this.#i)}getUserById(){this.#s.getUserById(this.userId()).subscribe(e=>{this.user.set(e),this.#l=[{name:"",email:e.email}],F.fieldConfig.options.set(this.#l),F.fieldConfig.isSearchable=!1,this.#i.unshift(...e.roles),this.setRoles(),this.updateFormFields(e.roleIds,e.roles)})}getUsersBasedOnRoleName(e,t,i){this.#s.getAll(e).subscribe({next:({payload:a})=>{let{content:o,totalElements:m}=a;t==="LINE_MANAGER"?(this.#m=i?o:[...this.#m,...o],T.fieldConfig.options.set(this.#m),this.#r.totalItems=m):(this.#p=i?o:[...this.#p,...o],R.fieldConfig.options.set(this.#p),this.#g.totalItems=m)}})}getLineManagers(){this.#t.roleKey="LINE_MANAGER",this.getUsersBasedOnRoleName(this.#t,"LINE_MANAGER")}getPMOCustodian(){this.#e.roleKey="PMO_CUSTODIAN",this.getUsersBasedOnRoleName(this.#e,"PMO_CUSTODIAN")}updateFormFields(e,t){(t||this.#i.filter(o=>e.includes(o.id))).some(o=>o.roleKey==="EMPLOYEE")?this.addValidatorsAndClasses():this.removeValidatorsAndClasses(),this.#n?.get("lineManagerId")?.updateValueAndValidity(),this.#n?.get("pmoCustodianId")?.updateValueAndValidity()}addValidatorsAndClasses(){let e=this.#n?.get("lineManagerId"),t=this.#n?.get("pmoCustodianId");e?.addValidators(P.required),t?.addValidators(P.required),T.class="input-gray mb-2",R.class="input-gray mb-2"}removeValidatorsAndClasses(){let e=this.#n?.get("lineManagerId"),t=this.#n?.get("pmoCustodianId");e?.clearValidators(),e?.setValue(""),t?.clearValidators(),t?.setValue(""),T.class="hidden",R.class="hidden"}onFormGroupChange(e){e&&(this.#n=e)}addNewUser(e,t){return this.#s.create(t).pipe(K(()=>e.isLoading=!1)).subscribe({next:i=>{this.#a.addAlert(s({message:"User created successfully"},Ge)),this.onTakeAction()({buttonConfig:e,value:t??{}},()=>{}),this.removeValidatorsAndClasses()}})}updateUser(e,t){let i=p(s({},t),{email:this.user().email});return this.#s.update(p(s({},i),{id:this.userId()})).pipe(K(()=>e.isLoading=!1)).subscribe({next:a=>{this.#a.addAlert(s({message:"User Updated successfully"},Be)),this.onTakeAction()({buttonConfig:e,value:i??{}},()=>{}),this.removeValidatorsAndClasses()}})}onTakeEvent(e){let{buttonConfig:t,value:i}=e;t.type===b.Submit?(e.buttonConfig.isLoading=!0,this.onSubmit(t,i)):(this.removeValidatorsAndClasses(),this.onTakeAction()({buttonConfig:t,value:i},()=>{}))}onSubmit(e,t){this.userId()?this.updateUser(e,t):this.addNewUser(e,t)}onScroll(e){switch(e){case"ROLES":if(this.#i.length===this.#c.totalItems)return;this.#o.pageable.pageIndex+=1,this.getRoles();break;case"LINE_MANAGER":if(this.#m.length===this.#r.totalItems)return;this.#t.pageable.pageIndex+=1,this.getUsersBasedOnRoleName(this.#t,"LINE_MANAGER");break;case"PMO_CUSTODIAN":if(this.#p.length===this.#g.totalItems)return;this.#e.pageable.pageIndex+=1,this.getUsersBasedOnRoleName(this.#e,"PMO_CUSTODIAN");break}}onSearch(e,t){switch(t){case"ROLES":this.#o.keyword=e,this.#o.pageable.pageIndex=0,this.getRoles(!0);break;case"LINE_MANAGER":this.#t.keyword=e,this.#t.pageable.pageIndex=0,this.getUsersBasedOnRoleName(this.#t,t,!0);break;case"PMO_CUSTODIAN":this.#e.keyword=e,this.#e.pageable.pageIndex=0,this.getUsersBasedOnRoleName(this.#e,t,!0);break}}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=M({type:n,selectors:[["app-add-new-user"]],inputs:{onTakeAction:[1,"onTakeAction"],userId:[1,"userId"]},features:[x([y,k])],decls:1,vars:5,consts:[[3,"event","formGroupChange","formFields","buttons","buttonClass","isStickyForm","initValue"]],template:function(t,i){t&1&&(l(0,"lib-muk-dynamic-form",0),A("event",function(o){return i.onTakeEvent(o)})("formGroupChange",function(o){return i.onFormGroupChange(o)}),c()),t&2&&d("formFields",i.formFields)("buttons",i.buttons)("buttonClass",i.buttonClass)("isStickyForm",!0)("initValue",i.user())},dependencies:[ne],encapsulation:2})};function it(n,e){if(n&1){let t=Y();l(0,"mat-chip-row",6),A("removed",function(){let a=U(t).$implicit,o=h();return O(o.removeChip(a))}),f(1),l(2,"button",7)(3,"mat-icon"),f(4,"close"),c()()()}if(n&2){let t,i=e.$implicit;r(),ve(" ",(t=i.roleName)!==null&&t!==void 0?t:i.name," "),r(),Ae("aria-label","remove "+i.name)}}var re=class n{onSelectValue=new Se;#s=u(y);#d=u(k);#o=g(I);#t=g(I);#e=g(I);#a=[];#n=[];#i=[];selectedChips=[];#l=g(N);#m=g(N);#p=g(N);#c=u(de);formFields=[w,ue,B,G,he];#r;ngOnInit(){this.initialize(),this.getRoles(),this.getLineManagers(),this.getPmoCustodians()}initialize(){w.fieldConfig.onSearch=e=>this.onSearch(e,"ROLES"),w.fieldConfig.onScroll=()=>this.onScroll("ROLES"),w.onChange=e=>this.onChangeValue(e,"ROLES"),G.fieldConfig.onSearch=e=>this.onSearch(e,"LINE_MANAGER"),G.fieldConfig.onScroll=()=>this.onScroll("LINE_MANAGER"),G.onChange=e=>this.onChangeValue(e,"LINE_MANAGER"),B.fieldConfig.onSearch=e=>this.onSearch(e,"PMO_CUSTODIAN"),B.fieldConfig.onScroll=()=>this.onScroll("PMO_CUSTODIAN"),B.onChange=e=>this.onChangeValue(e,"PMO_CUSTODIAN"),he.onChange=e=>this.onChangeValue(e,"UNKNOWN"),ue.onChange=e=>this.onChangeDate(e)}getRoles(e){this.#d.getAll(this.#o).subscribe({next:t=>{let{content:i}=t.payload;this.#a=e?i:[...this.#a,...i],w.fieldConfig.options.set(this.#a),this.#l.totalItems=t.payload.totalElements}})}getLineManagers(){this.#t.roleKey="LINE_MANAGER",this.getUsersBasedOnRoleName(this.#t,"LINE_MANAGER")}getPmoCustodians(){this.#e.roleKey="PMO_CUSTODIAN",this.getUsersBasedOnRoleName(this.#e,"PMO_CUSTODIAN")}getUsersBasedOnRoleName(e,t,i){this.#s.getAll(e).subscribe({next:({payload:a})=>{let{content:o,totalElements:m}=a;t==="LINE_MANAGER"?(this.#n=i?o:[...this.#n,...o],G.fieldConfig.options.set(this.#n),this.#m.totalItems=m):(this.#i=i?o:[...this.#i,...o],B.fieldConfig.options.set(this.#i),this.#p.totalItems=m)}})}onSearch(e,t){switch(t){case"ROLES":this.#o.keyword=e,this.#o.pageable.pageIndex=0,this.getRoles(!0);break;case"LINE_MANAGER":this.#t.keyword=e,this.#t.pageable.pageIndex=0,this.getUsersBasedOnRoleName(this.#t,t,!0);break;case"PMO_CUSTODIAN":this.#e.keyword=e,this.#e.pageable.pageIndex=0,this.getUsersBasedOnRoleName(this.#e,t,!0);break}}onChangeValue(e,t){let i={};switch(t){case"ROLES":i.roles=e;let a=this.#a.filter(C=>e.includes(C.id)).map(C=>p(s({},C),{roleKey:"ROLES"}));this.selectedChips=this.removeDuplicates(a,"ROLES");break;case"PMO_CUSTODIAN":i.pmoCustodians=e;let o=this.#i.filter(C=>e.includes(C.id)).map(C=>p(s({},C),{roleKey:"PMO_CUSTODIAN"}));this.selectedChips=this.removeDuplicates(o,"PMO_CUSTODIAN");break;case"LINE_MANAGER":i.lineManagers=e;let m=this.#n.filter(C=>e.includes(C.id)).map(C=>p(s({},C),{roleKey:"LINE_MANAGER"}));this.selectedChips=this.removeDuplicates(m,"LINE_MANAGER");break;case"UNKNOWN":i.keyword=e;break}this.onSelectValue.emit(i)}onScroll(e){switch(e){case"ROLES":if(this.#a.length===this.#l.totalItems)return;this.#o.pageable.pageIndex+=1,this.getRoles();break;case"LINE_MANAGER":if(this.#n.length===this.#m.totalItems)return;this.#t.pageable.pageIndex+=1,this.getUsersBasedOnRoleName(this.#t,"LINE_MANAGER");break;case"PMO_CUSTODIAN":if(this.#i.length===this.#p.totalItems)return;this.#e.pageable.pageIndex+=1,this.getUsersBasedOnRoleName(this.#e,"PMO_CUSTODIAN");break}}onChangeDate(e){if(e&&e.end!=""){let{start:t,end:i}=e;t=this.#c.transform(t,"yyyy-MM-dd"),i=this.#c.transform(i,"yyyy-MM-dd");let a=this.#c.transform(t,"d MMMM yyyy"),o=this.#c.transform(i,"d MMMM yyyy");this.selectedChips=this.removeDuplicates([{id:"DATE_RANGE",name:`${a} - ${o||""}`,roleKey:"DATE_RANGE"}],"DATE_RANGE"),this.onSelectValue.emit({from:t,to:i})}}removeDuplicates=(e,t)=>{let i=new Set(e.map(m=>m.id)),o=[...this.selectedChips.filter(m=>m.roleKey!==t||i.has(m.id)),...e];return[...new Map(o.map(m=>[`${m.id}_${m.roleKey}`,m])).values()]};removeChip(e){switch(this.selectedChips.splice(this.selectedChips.findIndex(t=>t.id==e.id),1),e.roleKey){case"ROLES":this.setValueAtFormGroup("roleIds",e.id);break;case"PMO_CUSTODIAN":this.setValueAtFormGroup("pmoCustodianId",e.id);break;case"LINE_MANAGER":this.setValueAtFormGroup("lineManagerId",e.id);break;case"DATE_RANGE":this.#r?.get("date")?.setValue(null),this.#r?.get("date")?.updateValueAndValidity(),this.onSelectValue.emit({from:void 0,to:void 0});break}}setValueAtFormGroup(e,t){let i=this.#r?.get(e)?.value?.filter(a=>a!=t);this.#r?.get(e)?.setValue(i)}onFormGroupChange(e){e&&(this.#r=e)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=M({type:n,selectors:[["app-filter"]],outputs:{onSelectValue:"onSelectValue"},features:[x([y,k,de])],decls:9,vars:1,consts:[[1,"grid","grid-cols-12","gap-1","items-baseline"],[1,"col-span-12","lg:col-span-1"],[1,"text-grey-200","text-sm","w-20","font-medium","text-start","lg:text-center"],[1,"col-span-12","lg:col-span-11"],[3,"formGroupChange","formFields"],[1,"flex","flex-wrap","w-[65%]"],[3,"removed"],["matChipRemove",""]],template:function(t,i){t&1&&(l(0,"section",0)(1,"div",1)(2,"div",2),f(3,"Filter by"),c()(),l(4,"div",3)(5,"lib-muk-dynamic-form",4),A("formGroupChange",function(o){return i.onFormGroupChange(o)}),c()()(),l(6,"div",5),z(7,it,5,2,"mat-chip-row",null,Ne),c()),t&2&&(r(5),d("formFields",i.formFields),r(2),$(i.selectedChips))},dependencies:[ne,Oe,Ue,We,ze,$e],encapsulation:2})};var ot=()=>[Z];function at(n,e){if(n&1&&(l(0,"div",1)(1,"div")(2,"div",2)(3,"div",3)(4,"span",4),f(5),c()(),l(6,"div",3)(7,"span",5),f(8),c()()()()()),n&2){let t=e.$implicit,i=e.$index,a=h(2);d("matTooltip",t.roleName),r(),be("card card-border-left-",a.classesCss[i]," w-full"),r(4),_(t.roleName),r(3),_(t.usersCount)}}function st(n,e){if(n&1&&(l(0,"div",0),z(1,at,9,6,"div",1,ce),c()),n&2){let t=h();r(),$(t.statistics)}}function rt(n,e){n&1&&(l(0,"div",6),E(1,"app-skeleton"),c())}function lt(n,e){if(n&1&&(l(0,"div",2),z(1,rt,2,0,"div",6,ce),c()),n&2){let t=h();r(),$(t.skeletonCount)}}var le=class n{statistics=[];skeletonCount=new Array(4);classesCss=["osis","primary","coral","yalow","orange"];static \u0275fac=function(t){return new(t||n)};static \u0275cmp=M({type:n,selectors:[["app-statistics-card"]],inputs:{statistics:"statistics"},decls:4,vars:1,consts:[[1,"card-grid"],[1,"card-item",3,"matTooltip"],[1,"grid","grid-cols-12","gap-2"],[1,"col-span-12"],[1,"truncated","max-w-40","title"],[1,"price"],[1,"card-item"]],template:function(t,i){t&1&&(D(0,st,3,0)(1,lt,3,0),Me(2,0,ot,null,1)),t&2&&(r(2),Ee(i.statistics))},dependencies:[qe,ee],encapsulation:2})};var fi=new W([{id:1,name:"Nasir Ali Aldusari",email:"nadir.dusari@stc.com.sa",role:"Employee",date:"22 Jul 2024  09:31 AM",image:"https://fakeimg.pl/300/",image2:"https://fakeimg.pl/300/"},{id:2,name:"Nasir Ali Aldusari",email:"nadir.dusari@stc.com.sa",role:"PMO",date:"22 Jul 2024  09:31 AM",image:"https://fakeimg.pl/300/",image2:"https://fakeimg.pl/300/"},{id:3,name:"Nasir Ali Aldusari",email:"nadir.dusari@stc.com.sa",role:"Employee",date:"22 Jul 2024  09:31 AM",image:"https://fakeimg.pl/300/",image2:"https://fakeimg.pl/300/"}]),mt=[{text:"Edit",isMukButton:!1,isLoading:!1,color:L.Outline_Light,matType:te.Basic,icon:"person",className:"edit-icon",isDisabled:!1,type:b.Button,toolTip:{position:De.Below,toolTip:"Edit"}}],et=[{label:"NAME",path:"name",type:v.Content,isPrimary:!0,contentIndex:0},{label:"EMAIL",path:"email",type:v.Text,mapValues:{true:"Yes",false:"No"},isTruncated:!0},{label:"ROLE",path:"roles",type:v.Text},{label:"CREATION DATE",path:"createdAt",type:v.Date},{label:"PMO CUSTODIAN",path:"pmoCustodian",type:v.Content,contentIndex:1},{label:"LINE MANAGER",path:"lineManager",type:v.Content,contentIndex:2},{label:" ",path:"actions1",type:v.Actions,actionsStyle:Je.Dots,actions:mt}];var J=class n extends Pe{constructor(){super(Le.statistics)}getUsersStatistics(){return this.http.get(`${this.constructedUrl}`).pipe(_e(e=>e.payload))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ye({token:n,factory:n.\u0275fac})};var pt=(n,e,t)=>[n,e,t];function ct(n,e){if(n&1&&(l(0,"div",13),E(1,"img",14),l(2,"span",15),f(3),c()()),n&2){let t=e.item,i=h();r(),d("src",i.imgUrl+t.profileImage,H),r(),d("matTooltip",t.name),r(),_(t.name)}}function dt(n,e){if(n&1&&(l(0,"div",13),E(1,"img",14),l(2,"span",15),f(3),c()()),n&2){let t=h().item,i=h();r(),d("src",i.imgUrl+t.pmoCustodianImage,H),r(),d("matTooltip",t.pmoCustodian),r(),_(t.pmoCustodian)}}function gt(n,e){if(n&1&&(l(0,"span",15),f(1),c()),n&2){let t=h().item;d("matTooltip",t.pmoCustodian),r(),_(t.pmoCustodian)}}function ut(n,e){if(n&1&&D(0,dt,4,3,"div",13)(1,gt,2,2,"span",15),n&2){let t=e.item;pe(t.pmoCustodian!="N/A"?0:1)}}function ht(n,e){if(n&1&&(l(0,"div",13),E(1,"img",14),l(2,"span",15),f(3),c()()),n&2){let t=h().item,i=h();r(),d("src",i.imgUrl+(t==null?null:t.lineManagerImage),H),r(),d("matTooltip",t.lineManager),r(),_(t.lineManager)}}function ft(n,e){if(n&1&&(l(0,"span",15),f(1),c()),n&2){let t=h().item;d("matTooltip",t.lineManager),r(),_(t.lineManager)}}function Ct(n,e){if(n&1&&D(0,ht,4,3,"div",13)(1,ft,2,2,"span",15),n&2){let t=e.item;pe(t.lineManager!="N/A"?0:1)}}var Ie=class n{imgUrl=xe.imgURL;#s=u(y);#d=u(Re);#o=u(Te);#t=u(we);#e=g(I);#a=u(J);buttons={buttons:[fe,oe],parentClass:""};tableConfig={dataSource:new W([]),displayedColumns:et,pageIndex:0,totalElements:0,pageSize:12,isLoading:!1,loadMoreButtonConfig:{text:"Load More",color:L.Primary,isMukButton:!0}};popupButton={buttons:[Ye,Qe],parentClass:""};statistics=[];constructor(){this.getUsers(),this.getStatistics(),this.initialize()}initialize(){fe.onClick=e=>this.#o.navigate(["user-permissions"],{relativeTo:this.#d}),oe.onClick=e=>this.openDialog({title:`${e?.element?"Edit":"Add New"}  User`,content:null,component:ae,inputs:e?.element?{userId:e.element.id}:{}},{width:"500px",height:"670px",panelClass:"custom-panel-class"})}onPaginatorChange(e){this.#e.pageable.pageIndex=e,this.tableConfig.pageIndex=e,this.getUsers()}onTakeAction(e){e.buttonConfig.text==="Deactivate"?this.openDialog({title:"Deactivate",message:"",content:null,component:je,inputs:{}},{width:"580px",height:"350px"}):e.buttonConfig.text==="Edit"&&oe.onClick(e)}openDialog(e,t){let i=this.#t.openDialog(p(s({},e),{inputs:p(s({},e.inputs),{onTakeAction:a=>this.onSendModalTakeEvent(a,i)})}),t)}onSendModalTakeEvent=(e,t)=>{let{buttonConfig:i}=e;i.type===b.Submit&&(this.getUsers(),this.getStatistics()),t.close()};getUsers(e){let t=e||this.#e;this.#e=s(s({},g(this.#e)),g(e)),this.tableConfig.isLoading=!0,this.#s.getUsersManagement(t).pipe(K(()=>this.tableConfig.isLoading=!1)).subscribe({next:i=>{let{content:a,totalElements:o}=i.payload;this.tableConfig.dataSource=new W(a),this.tableConfig.totalElements=o}})}handleValueChange(e){this.#e=s(p(s({},this.#e),{pageable:p(s({},this.#e.pageable),{pageIndex:0})}),e),this.getUsers(this.#e)}getStatistics(){this.#a.getUsersStatistics().subscribe({next:e=>{this.statistics=e}})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=M({type:n,selectors:[["app-users-management-list"]],features:[x([y,J])],decls:17,vars:8,consts:[["nameAvatar",""],["pmoAvatar",""],["lineManagerAvatar",""],[1,"grid-layout"],[1,"title-section"],[1,"title-page","mb-2","lg:mb-0"],[1,"button-section"],[3,"config"],[3,"statistics"],[1,"section-wrapper"],[3,"paginatorChange","takeAction","config","contents"],["actions","",1,"table-actions"],[3,"onSelectValue"],[1,"flex","items-center","gap-3"],["onerror","this.onerror=null;this.src='./assets/images/icons/avatar.png';","alt","person-icon",1,"w-9","h-9","rounded-full","object-cover",3,"src"],[1,"truncate-width",3,"matTooltip"]],template:function(t,i){if(t&1){let a=Y();l(0,"div",3)(1,"div",4)(2,"div",5),f(3,"User Management"),c()(),l(4,"div",6),E(5,"lib-muk-dynamic-buttons",7),c()(),E(6,"app-statistics-card",8),l(7,"section",9)(8,"lib-muk-table",10),A("paginatorChange",function(m){return U(a),O(i.onPaginatorChange(m))})("takeAction",function(m){return U(a),O(i.onTakeAction(m))}),l(9,"div",11)(10,"app-filter",12),A("onSelectValue",function(m){return U(a),O(i.handleValueChange(m))}),c()()()(),D(11,ct,4,3,"ng-template",null,0,X)(13,ut,2,1,"ng-template",null,1,X)(15,Ct,2,1,"ng-template",null,2,X)}if(t&2){let a=Q(12),o=Q(14),m=Q(16);r(5),d("config",i.buttons),r(),d("statistics",i.statistics),r(2),d("config",i.tableConfig)("contents",Fe(4,pt,a,o,m))}},dependencies:[He,re,ke,le,ee,Z],styles:["img[alt=person-icon][_ngcontent-%COMP%]{height:24px;width:24px}"]})};export{Ie as default};
