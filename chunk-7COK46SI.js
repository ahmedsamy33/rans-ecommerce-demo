import{a as re,b as g}from"./chunk-BTGBWRQG.js";import{a as te}from"./chunk-CGFSL3JU.js";import{a as Q,c as X}from"./chunk-76MIRPDM.js";import{a as oe}from"./chunk-UZW6OXPX.js";import{c as q}from"./chunk-DFF2A2V2.js";import{a as O}from"./chunk-XE4SEQK7.js";import{a as j,b as $}from"./chunk-Q75O5SUG.js";import{a as ne}from"./chunk-V24KNJUK.js";import{b,d as Y,g as Z,h as ee,r as ie}from"./chunk-MTOQREGE.js";import"./chunk-IZOBXTRQ.js";import{a as H,b as J,c as K}from"./chunk-JEHFEJHR.js";import{a as G}from"./chunk-3LCGF45W.js";import"./chunk-SNTC6ISU.js";import"./chunk-5UOHSEQ7.js";import"./chunk-LGSLEHKQ.js";import{f as W,g as z,h as f,i as y}from"./chunk-6ZSGU6WM.js";import"./chunk-WJCMRRD3.js";import"./chunk-SYIRRWMM.js";import"./chunk-T3Q3DASN.js";import"./chunk-LLJ4QRQX.js";import"./chunk-EKTMPHIH.js";import"./chunk-E4P4CAIP.js";import{Ba as x,Db as L,Eb as R,Gb as c,J as _,Mb as V,Nb as k,Pb as N,Qb as A,Rb as a,Sb as r,Tb as B,Xb as M,_b as I,ac as d,cb as p,ea as l,lb as u,na as E,oa as F,oc as v,qb as h,qc as U,vc as S,xb as D}from"./chunk-VU6Q4IP4.js";import{a as n,b as s}from"./chunk-TSRGIXR5.js";var se=new Z(n({},oe({label:"Group Name *",placeholder:"Group Name",key:"groupName",validators:[b.required,b.maxLength(50)],class:"input-text-gray mb-1",fieldConfig:{type:Y.Text}}))),P=new ee(s(n({},Q({label:"Permissions *",placeholder:"Select Permissions",validators:[b.required],key:"permissions"})),{class:"input-gray mb-2",fieldConfig:s(n({},X()),{isSearchable:!0,searchConfig:{placeholder:"Permissions",noEntriesFound:""},isMultiple:!0,options:u([]),onRemove:o=>console.log("remove",o),onButtonClick:o=>console.log(o),onScroll:o=>console.log("onScroll",o),onSearch:o=>console.log("onSearch",o)}),onChange:o=>console.log("onChange",o)})),ae=s(n({},G({text:"Submit",type:f.Submit})),{className:"btn btn--primary w-30"}),me=s(n({},G({text:"Cancel",color:y.Warn,matType:z.Flat})),{className:"btn btn--light-gray w-30"});var T=class o{#i=l(re);#e=l(g);permissionGroupId=x(0);permissionGroup=u({});onTakeAction=x.required();formFields=[se,P];buttons=[me,ae];buttonClass="justify-content-start";ALERT_SERVICE=l(K);ngOnInit(){this.getPermissions(),this.permissionGroupId()&&this.getPermissionGroupsById(),this.initialize()}initialize(){P.fieldConfig.onSearch=e=>this.onSearchPermissions(e)}addNewPermissionGroup(e,i){this.#e.create(i).pipe(_(()=>e.isLoading=!1)).subscribe(t=>{this.ALERT_SERVICE.addAlert(n({message:"Permission created successfully"},H)),this.onTakeAction()({buttonConfig:e,value:i??{}},()=>{})})}updatePermissionGroup(e,i){this.#e.update(s(n({},i),{id:this.permissionGroupId()})).pipe(_(()=>e.isLoading=!1)).subscribe(t=>{this.ALERT_SERVICE.addAlert(n({message:"Permission updated successfully"},J)),this.onTakeAction()({buttonConfig:e,value:i??{}},()=>{})})}onTakeEvent(e){let{buttonConfig:i,value:t}=e;i.type===f.Submit?(i.isLoading=!0,this.onSubmit(i,t)):this.onTakeAction()({buttonConfig:i,value:t},()=>{})}onSubmit(e,i){this.permissionGroupId()?this.updatePermissionGroup(e,i):this.addNewPermissionGroup(e,i)}getPermissions(){this.#i.permissions$.subscribe(e=>P.fieldConfig.options.set(e))}getPermissionGroupsById(){this.#e.getPermissionsByGroupId(this.permissionGroupId()).subscribe(e=>this.permissionGroup.set(e))}onSearchPermissions(e){this.#i.permissions$.subscribe(i=>{let t=i.filter(m=>m.valueEn?.toLowerCase().includes(e?.toLowerCase()));P.fieldConfig.options.set(e?.trim()?.length?t:i)})}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=h({type:o,selectors:[["app-add-permission-group"]],inputs:{permissionGroupId:[1,"permissionGroupId"],onTakeAction:[1,"onTakeAction"]},features:[S([g])],decls:1,vars:5,consts:[[3,"event","initValue","formFields","buttons","isStickyForm","buttonClass"]],template:function(i,t){i&1&&(a(0,"lib-muk-dynamic-form",0),I("event",function(C){return t.onTakeEvent(C)}),r()),i&2&&c("initValue",t.permissionGroup())("formFields",t.formFields)("buttons",t.buttons)("isStickyForm",!0)("buttonClass",t.buttonClass)},dependencies:[ie],encapsulation:2})};var pe=s(n({},G({text:"Add New Group",icon:"add",color:y.Warn})),{className:"btn btn--primary-transparent btn--add-user-transparent",onClick:o=>{}});var ce=()=>[import("./chunk-FD6GCQBE.js").then(o=>o.CardItemComponent),ne];function de(o,e){if(o&1){let i=M();a(0,"div",4)(1,"app-card-item",6),I("onClickCard",function(m){E(i);let C=d(2);return F(C.onOpenDialog(m))}),r()()}if(o&2){let i=e.$implicit;p(),c("item",i)}}function fe(o,e){o&1&&(a(0,"div",5)(1,"p",7),v(2,"No Groups Found"),r()())}function ge(o,e){if(o&1){let i=M();a(0,"lib-muk-pagination",8),I("pageIndexChange",function(m){E(i);let C=d(2);return F(C.onPaginatorChange(m))}),r()}if(o&2){let i=d(2);c("config",i.paginationConfig)}}function Ce(o,e){if(o&1&&(a(0,"div",3),N(1,de,2,1,"div",4,k,!1,fe,3,0,"div",5),r(),D(4,ge,1,1,"lib-muk-pagination",2)),o&2){let i=d();p(),A(i.permissionGroups()),p(3),V(i.permissionGroups().length?4:-1)}}function _e(o,e){o&1&&(a(0,"div",4),B(1,"app-skeleton"),r())}function Ie(o,e){if(o&1&&(a(0,"div",3),N(1,_e,2,0,"div",4,k),r()),o&2){let i=d();p(),A(i.skeletonCount)}}function Ge(o,e){o&1&&(a(0,"p"),v(1,"Failed to load large component."),r())}var w=class o{#i=l(g);#e=l(q);#o=O(j);buttonConfig=pe;permissionGroups=u([]);paginationConfig=O($);isLoading=u(!1);skeletonCount=new Array(12);constructor(){this.initialize()}ngOnInit(){this.getPermissionGroups()}initialize(){this.buttonConfig.onClick=e=>this.onOpenDialog()}onOpenDialog(e){this.openDialog({title:`${e?"Edit":"Add New"}  Group`,message:"",content:null,component:T,inputs:e?{permissionGroupId:e.id}:{}},{width:"500px",height:"450px"})}openDialog(e,i){let t=this.#e.openDialog(s(n({},e),{inputs:s(n({},e.inputs),{onTakeAction:m=>this.onSendModalTakeEvent(m,t)})}),i)}onSendModalTakeEvent=(e,i)=>{let{buttonConfig:t,value:m}=e;t.type===f.Submit&&this.getPermissionGroups(),i.close()};getPermissionGroups(){this.isLoading.set(!0),this.#i.getAll(this.#o).pipe(_(()=>this.isLoading.set(!1))).subscribe({next:e=>{let{content:i,totalElements:t}=e.payload;this.permissionGroups.set(i),this.paginationConfig.totalItems=t}})}onPaginatorChange(e){this.#o.pageable.pageIndex=e,this.getPermissionGroups()}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=h({type:o,selectors:[["app-permission-groups"]],features:[S([g])],decls:10,vars:3,consts:[[1,"flex","items-center","justify-between"],[1,"text-grey-200","text-sm"],[3,"config"],[1,"grid","grid-cols-12","gap-4","mt-4"],[1,"col-span-12","lg:col-span-3"],[1,"col-span-12"],[3,"onClickCard","item"],[1,"text-grey-200","text-center"],[3,"pageIndexChange","config"]],template:function(i,t){i&1&&(a(0,"section")(1,"div",0)(2,"div",1),v(3),r(),B(4,"lib-muk-button",2),r(),D(5,Ce,5,2)(6,Ie,3,0)(7,Ge,2,0),L(8,5,ce,null,6,7),r()),i&2&&(p(3),U(" ",t.permissionGroups().length," Active Groups "),p(),c("config",t.buttonConfig),p(4),R(!t.isLoading()))},dependencies:[W,te],encapsulation:2})};export{w as default};
